<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Help Desk</title>
    <link rel="stylesheet" href="css/bulma.min.css">
	
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
	
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Lobster+Two&display=swap" rel="stylesheet">


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Lora&display=swap" rel="stylesheet">

<link rel="stylesheet" href="css/sweetalert2.min.css">
<script src="js/sweetalert2.min.js"></script>


<link href="css/aos.css" rel="stylesheet">
<script src="js/aos.js"></script>

<script src="js/jquery.min.js"></script>
	
	
  </head>
  <body style="font-family: 'Lora', serif;">

<svg viewbox="0 0 800 400">
      <path fill="#000099" d="
        M 800 400
        Q 200 300 0 270
        L 0 0
        L 800 0
    " />
</svg>

<span style="font-family: 'Lobster Two', cursive; position:absolute; top:10px; left:10px; font-size: 36px; color:white">
Halo Kominfo Deli
</span>


  <section  class="section" style="position:absolute; top:12%; margin:5%; width:90%; background-color:white; z-index:9; padding:15px; border-radius:12px; ">







    <div class="container" style="padding:5px">
	







<script>
let val_nama = localStorage.getItem('nama');
 let val = localStorage.getItem('useron');
  let val_idoperator = localStorage.getItem('idoperator');
  
 </script>





<div data-aos="fade-up">


<script>
function getUrlVars(param=null)
{
	if(param !== null)
	{
		var vars = [], hash;
		var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
		for(var i = 0; i < hashes.length; i++)
		{
			hash = hashes[i].split('=');
			vars.push(hash[0]);
			vars[hash[0]] = hash[1];
		}
		return vars[param];
	} 
	else 
	{
		return null;
	}
}



var id = getUrlVars("id");


 

</script>	

<div class="data">


<form id="form-data" class="col s12 form-user">

<script type="text/javascript">

 function page(page = 1){
  $.ajax({
   'url': 'https://helpdesk.deliserdangkab.go.id/profil_o.php?id='+id,
   'type': 'GET',
   'dataType': 'JSON',
   'data': {
    page: page
   },
   'success': function(response){
    draw_data(response);
   }
  });
 }

 function draw_data(response){
  // console.log(response);
  var data = $('.data');
  var content = '';

  for(var i=0; i<response.data.length; i++){

   ii=i+1;
   





   content += '<input type="hidden" name="idoperator" id="idoperator" value="'+ response.data[i].idoperator +'">';
   
  
 content += 'Form edit profile<br><div class="field">';
  content += '<label class="label">Nama</label>';
  content += '<div class="control  has-icons-right">';
   content += '<input class="input" type="text" name="namaoperator" id="namaoperator" value="'+ response.data[i].namaoperator +'">';
	content += '<span class="icon is-small is-right">';
      content += '<i class="fas fa-address-book"></i>';
    content += '</span>	';
  content += '</div>';
content += '</div>';

content += '<div class="field">';
  content += '<label class="label">No. HP</label>';
  content += '<div class="control">';
    content += '<div class="control  has-icons-right">';
    content += '<input class="input" type="text" name="hp" id="hp" value="'+ response.data[i].hp +'">';
				content += '<span class="icon is-small is-right">';
      content += '<i class="fas fa-calendar"></i>';
    content += '</span>	';
  content += '</div>';
content += '</div>';






content += '<br><div class="field">';
  content += '<label class="label">Password</label>';
    content += '<div class="control  has-icons-right">';
    content += '<input class="input" type="text" name="pass" id="pass" value="'+ response.data[i].pass +'">';
	content += '<span class="icon is-small is-right">';
      content += '<i class="fas fa-lock"></i>';
    content += '</span>	';
  content += '</div>';
content += '</div>';






	 	  
	  
	  
   
  }

  data.append(content);
 }

 page(1);
</script>

</div>
<br>
<a class="tombol-daftar button is-primary" id="simpan"><i class="fas fa-edit"></i> &nbsp;update profile</a>


</form>







<script type="text/javascript">



	$(document).ready(function(){
		$("#simpan").click(function(){
		

document.getElementById("simpan").innerHTML = "Loading..";		

	        let formData = new FormData();
	  

			


			formData.append('idoperator', $('#idoperator').val());
			formData.append('hp', $('#hp').val());
			formData.append('namaoperator', $('#namaoperator').val());
			formData.append('user', $('#user').val());
			formData.append('pass', $('#pass').val());

		
			
			var data = $('.form-user').serialize();
			$.ajax({
			    dataType: 'json',
				type: 'POST',
				url: "https://helpdesk.deliserdangkab.go.id/editoperator.php",
				data: formData,
				cache: false,
	            processData: false,
	            contentType: false,
				
				success: function(response) {
				
document.getElementById("simpan").innerHTML = "Update profile";				
	
	

if (response.gagal) { // key gagal dikembalikan
          
		  
const Toast = Swal.mixin({
  toast: true,
  position: 'top-end',
  showConfirmButton: false,
  timer: 3000
});

Toast.fire({
  type: 'error',
  title: 'Permohonan gagal !'
})



}


else if (response.tidak) { // key gagal dikembalikan
          
		  
const Toast = Swal.mixin({
  toast: true,
  position: 'top-end',
  showConfirmButton: false,
  timer: 3000
});

Toast.fire({
  type: 'error',
  title: 'File berkas tidak valid !'
})



}








else if (response.pernah) { // key gagal dikembalikan
          
		  

Swal.fire({
  title: 'Data gagal di kirim',
  text: "Anda baru saja pengajuan pengurusan layanan lainnya, silahkan tunggu pengurusan sebelumnya sampai selesai",
  type: 'error',
  showCancelButton: false,
  confirmButtonColor: '#3085d6',
  
  confirmButtonText: 'OK'
}).then((result) => {
  if (result.value) {


window.location="../index.html?user_on="+param1;

  }
})
	



}








	

else if (response.kosong) { // key gagal dikembalikan
          
		  
const Toast = Swal.mixin({
  toast: true,
  position: 'top-end',
  showConfirmButton: false,
  timer: 3000
});

Toast.fire({
  type: 'error',
  title: 'Mohon lengkapi data anda !'
})
			  
		  
 } else {



 
 
const Toast = Swal.mixin({
  toast: true,
  position: 'top-end',
  showConfirmButton: false,
  timer: 3000
});

Toast.fire({
  type: 'success',
  title: 'Update profile sukses !'
})
		

setTimeout(function () 
{
window.location="profil_o.html?id="+val_idoperator;
}, 1500);



}






				
				}
			});
		});
	});
	</script>	
	
	
	














<br>




    </div>
  </section>
  </body>
</html>






















<script>
let val_nama = localStorage.getItem('nama');
 let val = localStorage.getItem('useron');
  let val_idoperator = localStorage.getItem('idoperator');
   let val_jabatan = localStorage.getItem('jabatan');
  
 </script>



<div id="modal-js-example" class="modal" style="padding:20px">
  <div class="modal-background"></div>

  <div class="modal-content">
    <div class="box">
<center>	
<i style="font-size:36px" class="fas fa-user-circle" aria-hidden="true"></i>

</center>
<br />	
<center>
<span class="tag is-info">Teknisi</span>

<br><font size="+1"><script> document.write(val_nama); </script></font>
<hr>

  </center>  
	</div>
  </div>

  <button class="modal-close is-large" aria-label="close"></button>
</div>






<script>
function getUrlVars(param=null)
{
	if(param !== null)
	{
		var vars = [], hash;
		var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
		for(var i = 0; i < hashes.length; i++)
		{
			hash = hashes[i].split('=');
			vars.push(hash[0]);
			vars[hash[0]] = hash[1];
		}
		return vars[param];
	} 
	else 
	{
		return null;
	}
}



var id = getUrlVars("id");

 document.getElementById('idmasalahok').value = id;
  document.getElementById('idteknisi').value = val_idteknisi;
 

</script>	








<script>   
     AOS.init(); 
</script>


<script src="js/modal.js"></script>